---
import Card from '@/components/Card.astro'
import Layout from '../../layouts/Layout.astro'
import { getCollection } from 'astro:content'
import SectionContainer from '@/layouts/SectionContainer.astro'

export async function getStaticPaths() {
    const posts = await getCollection('posts')
    return posts.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }))
}

const allPosts = await getCollection('posts')
---

<Layout title="post">
    <SectionContainer>
        <ul>
            {
                allPosts.map((post) => (
                    <Card 
                        href={`/posts/${post.slug}/`} 
                        title={post.data.title}
                        body={post.data.description}
                        imageSrc={`/assets/${post.slug}.jpg`}
                        imageAlt={post.data.title}
                        badge={`${new Date(post.data.pubDate).toLocaleDateString()}`}
                    />
                ))
            }
        </ul>
    </SectionContainer>
</Layout>

<style>
    ul {
        display: grid;
        grid-auto-flow: row;
        gap: 2rem;
        padding: 0;
        margin-block: var(--size-fluid-5); 
        width: 100%;
    }
</style>
